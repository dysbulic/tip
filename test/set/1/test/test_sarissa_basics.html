<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<!--
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>Sarissa's Basic XML Functions</title>
    <link type="text/css" rel="stylesheet" href="javascript_test.css" />
    <style type="text/css">
    </style>
    <script type="text/javascript" src="../slideshow/sarissa/sarissa.js"></script>
    <script type="text/javascript">
      function debug(text) {
        var debugArea = document.createElement("div");
        debugArea.appendChild(document.createTextNode(text));
        //debugArea.innerHTML = text;
        document.getElementsByTagName("body").item(0).appendChild(debugArea);
      }
      function debugBreak() {
        document.getElementsByTagName("body").item(0)
          .appendChild(document.createElement("hr"));
      }
    </script>
    <script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
    <script type="text/javascript">
      _uacct = "UA-939849-1";
      urchinTracker();
    </script>
  </head>
  <body>
    <p>I'm having a hard time with the DOM functions in IE and want to
    use <a href="http://sourceforge.net/projects/sarissa/">Sarissa</a>
    to mask that. Unfortunately, the Sarissa document does not seem to
    provide <code>getElementById</code> either.</p>
    <form action="" onsubmit="eval(this['code'].value); return false">
      <div style="height: 90%">
        <textarea name="code" cols="" rows=""
>var oDomDoc = Sarissa.getDomDocument();
// we add a listener for the load event to know when loading is finished
function handler() {
  if(oDomDoc.readyState == 4) {
    debug("Document loaded with parse status: " + Sarissa.getParseErrorText(oDomDoc));
    debug("Document.getElementById = " + oDomDoc.getElementById);
    debug("Document.all = " + oDomDoc.all);
    debug("Document.responseXML = " + oDomDoc.responseXML);
    debug("Document.documentElement = " + oDomDoc.documentElement);
    if(oDomDoc.documentElement)
      debug("Document.documentElement.selectSingleNode = " + typeof(oDomDoc.documentElement.selectSingleNode));
    debug("Document.childNodes = " + oDomDoc.childNodes);
    debug("Document.childNodes.length = " + oDomDoc.childNodes.length);
    if(oDomDoc.childNodes.length > 0)
      debug("Document.childNodes.item(0).nodeName = " + oDomDoc.childNodes.item(0).nodeName);
    debug("Document.selectSingleNode = " + typeof(oDomDoc.selectSingleNode));
    if(oDomDoc.selectSingleNode)
      debug("Document.selectSingleNode(\"//body\") = " + oDomDoc.documentElement.selectSingleNode("//body"));
  }
};
oDomDoc.onreadystatechange = handler;
oDomDoc.load(window.location.pathname.replace(/\.[^\.]+$/, ".xml"));</textarea>
      </div>
      <div><input type="submit" value="Go"></input></div>
    </form>
  </body>
</html>
